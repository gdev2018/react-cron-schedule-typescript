"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var a=t(e);const n={SetRepeat:"SetRepeat",SetFrequency:"SetFrequency",SetMonthOption:"SetMonthOption",SetSelectedWeeks:"SetSelectedWeeks",SetMonthDate:"SetMonthDate",SetMonthDay:"SetMonthDay",SetMonthDayOrder:"SetMonthDayOrder",SetInitialProps:"SetInitialProps",SetEndType:"SetEndType",SetEndDate:"SetEndDate",SetEndCount:"SetEndCount",SetStartDate:"SetStartDate",SetCronExp:"SetCronExp"},l=(e=null)=>{let t=new Date;e&&(t=new Date(e));let a=t.getDate(),n=t.getMonth()+1;return a<10&&(a=`0${a}`),n<10&&(n=`0${n}`),`${t.getFullYear()}-${n}-${a}`},o=e=>"number"==typeof e?l(e):e,r=(e,t)=>{switch(t.type){case n.SetRepeat:return{...e,repeat:t.payload};case n.SetFrequency:return{...e,frequency:Number(t.payload)};case n.SetMonthOption:return{...e,monthOption:t.payload};case n.SetSelectedWeeks:return{...e,selectedWeeks:t.payload||[]};case n.SetMonthDate:return{...e,selectedMonthDate:Number(t.payload)};case n.SetMonthDay:return{...e,selectedMonthDay:t.payload};case n.SetMonthDayOrder:return{...e,selectedMonthDayOrder:t.payload};case n.SetStartDate:return{...e,startDate:t.payload};case n.SetEndType:return{...e,selectedEndType:t.payload};case n.SetEndDate:return{...e,endDate:t.payload};case n.SetEndCount:return{...e,endCount:Number(t.payload)};case n.SetInitialProps:return{...e,repeat:t.payload?.repeat||"weekly",disabled:t.payload?.disabled,showFrequency:t.payload?.showFrequency,frequency:t.payload?.frequency||1,startDate:t.payload?.startDate?o(t.payload?.startDate):l(),endDate:t.payload?.endDate?o(t.payload?.endDate):l(),selectedEndType:t.payload?.selectedEndType||"noend",endCount:t.payload?.endCount||10,selectedWeeks:t.payload?.selectedWeeks||[(new Date).getDay()],monthOption:t.payload?.monthOption||"standard",selectedMonthDate:t.payload?.selectedMonthDate||(new Date).getDate(),selectedMonthDayOrder:t.payload?.selectedMonthDayOrder||"First",selectedMonthDay:t.payload?.selectedMonthDay||"Day"};case n.SetCronExp:return{...e,cronExpression:t.payload};default:return e}},d=e.createContext({}),c={repeat:"weekly",frequency:1,selectedWeeks:[(new Date).getDay()],monthOption:"standard",selectedMonthDate:(new Date).getDate(),selectedMonthDayOrder:"First",selectedMonthDay:"Day",selectedEndType:"noend",startDate:l(),endDate:l(),endCount:10,disabled:!1,showFrequency:!0,cronExpression:""};var s=t=>{const[n,l]=e.useReducer(r,c);return a.default.createElement(d.Provider,{value:{recurrenceData:n,dispatch:l}},t.children)};const i=[{name:"Sunday",value:0},{name:"Monday",value:1},{name:"Tuesday",value:2},{name:"Wednesday",value:3},{name:"Thursday",value:4},{name:"Friday",value:5},{name:"Saturday",value:6}],u=["January","February","March","April","May","June","July","August","September","October","November","December"],y=e=>e&&e.length>0?7===e.length?"0 0 ? * ?":(e.sort(),`0 0 ? * ${e.join(",")}`):"",m=e=>e&&e>=1&&e<=31?`0 0 ${e} * ?`:"",p=e=>{const t=i.find((t=>t.name===e))?.value;return t>=0&&t<=6?`0 0 ? * ${t}L`:""},_=(e,t)=>{const a=i.find((e=>e.name===t))?.value;return e>=1&&e<=4&&a>=0&&a<=6?`0 0 ? * ${a}#${e}`:""},h=e=>"First"===e?1:"Second"===e?2:"Third"===e?3:"Fourth"===e?4:5,f=e=>1===e||"1"===e?"First":2===e||"2"===e?"Second":3===e||"3"===e?"Third":4===e||"4"===e?"Fourth":"Last",D=(e,t)=>{if(!t)return{};const a=t.split(" ");if(a.length<5)return{};const n={},l=a[4],o=a[3],r=a[2];if("weekly"===e){if(n.selectedWeeks="?"===l?[0,1,2,3,4,5,6]:l.split(",").map((e=>Number(e))),"?"===l)return n.selectedWeeks=[0,1,2,3,4,5,6],n;const e=[];return l.split(",").forEach((t=>{if(Number.isNaN(t)||Number.isNaN(parseFloat(t))){const n="SUN"===(a=t)?.toUpperCase()?0:"MON"===a?.toUpperCase()?1:"TUE"===a?.toUpperCase()?2:"WED"===a?.toUpperCase()?3:"THU"===a?.toUpperCase()?4:"FRI"===a?.toUpperCase()?5:"SAT"===a?.toUpperCase()?6:void 0;n&&e.push(n)}else e.push(Number(t));var a})),n.selectedWeeks=e,n}if("*"===o&&"monthly"===e){if("?"===l&&!isNaN(r)&&!isNaN(parseFloat(r)))return n.monthOption="standard",n.selectedMonthDate=Number(r),n;if(n.monthOption="custom","?"===l)r.includes("L")&&(n.selectedMonthDayOrder="Last"),r.includes("W")?(n.selectedMonthDay="Weekday",n.selectedMonthDayOrder=f(r.slice(0,1))):n.selectedMonthDay="Day";else if(l.includes("L")){const e=i.find((e=>e.value===Number(l.slice(0,1))));n.selectedMonthDay=e?.name}else if(l.includes("#")){n.selectedMonthDayOrder=f(l.charAt(l.length-1));const e=i.find((e=>e.value===Number(l.slice(0,1))));n.selectedMonthDay=e?.name}return n}return n};function S(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var n=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css","top"===a&&n.firstChild?n.insertBefore(l,n.firstChild):n.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e))}}var b={mainContainer:"DateSelection-module_mainContainer__Jn8mk",endType:"DateSelection-module_endType__g3adX",endContainer:"DateSelection-module_endContainer__vEHSM",startDate:"DateSelection-module_startDate__-Y2W4",endCount:"DateSelection-module_endCount__GG4GH"};function E(t){const l=t?.styles||{},{recurrenceData:o,dispatch:r}=e.useContext(d),{selectedEndType:c,startDate:s,endDate:i,endCount:u,disabled:y}=o;return a.default.createElement("div",{className:b.mainContainer,style:l.dateContainer},a.default.createElement("div",{className:b.startContainer},a.default.createElement("label",{style:l.startLabel},"Start"),a.default.createElement("input",{disabled:y,value:s,onChange:e=>{r({type:n.SetStartDate,payload:e?.target?.value})},className:b.startDate,style:l.startDate,type:"date",id:"start",name:"start"})),a.default.createElement("div",{className:b.endContainer},a.default.createElement("label",{style:l.endLabel},"End"),a.default.createElement("select",{key:"endType",disabled:y,value:c,className:b.endType,style:l.endType,onChange:e=>{r({type:n.SetEndType,payload:e?.target?.value})}},a.default.createElement("option",{key:"noend",value:"noend"},"no end date"),a.default.createElement("option",{key:"date",value:"date"},"on this day"),a.default.createElement("option",{key:"count",value:"count"},"after")),"date"===c?a.default.createElement("input",{disabled:y,value:i,onChange:e=>{r({type:n.SetEndDate,payload:e?.target?.value})},className:b.endDate,style:l.endDate,type:"date",id:"end",name:"end"}):"count"===c?a.default.createElement(a.default.Fragment,null,a.default.createElement("input",{disabled:y,value:u,onChange:e=>{r({type:n.SetEndCount,payload:e?.target?.value})},className:b.endCount,style:l.endCount,type:"number",min:1}),a.default.createElement("label",{style:{marginLeft:10}},"occurance")):null))}S("@media only screen and (min-width:641px){.DateSelection-module_mainContainer__Jn8mk{display:flex;flex-direction:row}.DateSelection-module_endType__g3adX{margin-left:20px}}@media only screen and (max-width:641px){.DateSelection-module_endContainer__vEHSM{margin-top:20px}.DateSelection-module_endType__g3adX{margin-left:24px}}.DateSelection-module_mainContainer__Jn8mk{margin-top:20px}.DateSelection-module_startDate__-Y2W4{margin-left:20px;margin-right:20px}.DateSelection-module_endType__g3adX{margin-right:20px}.DateSelection-module_endCount__GG4GH{width:50px}");var k={mainContainer:"Frequency-module_mainContainer__uyQ55",frequencyContainer:"Frequency-module_frequencyContainer__VDM6E",frequencyInput:"Frequency-module_frequencyInput__2mARX",repeatLabel:"Frequency-module_repeatLabel__gfsCa",repeatDropdown:"Frequency-module_repeatDropdown__4WO9R",everyLabel:"Frequency-module_everyLabel__dFHFF",selectedRepeatlLabel:"Frequency-module_selectedRepeatlLabel__jdy-U"};S("@media only screen and (min-width:641px){.Frequency-module_mainContainer__uyQ55{display:flex;flex-direction:row}}@media only screen and (max-width:641px){.Frequency-module_frequencyContainer__VDM6E{margin-top:20px}.Frequency-module_frequencyInput__2mARX{margin-left:6px}}.Frequency-module_repeatLabel__gfsCa{margin-right:20px}.Frequency-module_repeatDropdown__4WO9R{margin-right:40px;width:80px}.Frequency-module_everyLabel__dFHFF{margin-right:20px}.Frequency-module_frequencyInput__2mARX{width:50px}.Frequency-module_selectedRepeatlLabel__jdy-U{margin-left:10px}");const C=["weekly","monthly"];function g(t){const l=t?.styles||{},{recurrenceData:o,dispatch:r}=e.useContext(d),{repeat:c,showFrequency:s,frequency:i,disabled:u}=o;return a.default.createElement("div",{className:k.mainContainer,style:l.frequencyContainer},a.default.createElement("div",null,a.default.createElement("label",{className:k.repeatLabel,style:l.repeatLabel},"Repeat"),a.default.createElement("select",{key:"repeat",style:l.repeatDropdown,disabled:u,value:c,className:k.repeatDropdown,name:"repeat",id:"repeat",onChange:e=>{r({type:n.SetRepeat,payload:e?.target?.value})}},C.map((e=>a.default.createElement("option",{key:e,value:e},e))))),s&&a.default.createElement("div",{className:k.frequencyContainer},a.default.createElement("label",{className:k.everyLabel,style:l.everyLabel},"Every"),a.default.createElement("input",{style:l.frequencyInput,disabled:u,className:k.frequencyInput,value:i,onChange:e=>{r({type:n.SetFrequency,payload:e?.target?.value})},type:"number",min:1}),a.default.createElement("label",{className:k.selectedRepeatlLabel,style:l.selectedRepeatlLabel},c?.slice(0,-2),"(s)")))}var x={container:"MonthSelection-module_container__7AbBI",orLabel:"MonthSelection-module_orLabel__jqTMH",mainContainer:"MonthSelection-module_mainContainer__Orlve",standardContainer:"MonthSelection-module_standardContainer__1EEb-",customContainer:"MonthSelection-module_customContainer__4XPHq",dayDropdown:"MonthSelection-module_dayDropdown__bxWL2",orderDropdown:"MonthSelection-module_orderDropdown__H0a7L",monthWeekdayDropdown:"MonthSelection-module_monthWeekdayDropdown__RoW6n",dayLabel:"MonthSelection-module_dayLabel__C04BX",onLabel:"MonthSelection-module_onLabel__TJ8AO"};S("@media only screen and (min-width:641px){.MonthSelection-module_container__7AbBI{display:flex;flex-direction:row}}@media only screen and (max-width:641px){.MonthSelection-module_orLabel__jqTMH{visibility:hidden}}.MonthSelection-module_mainContainer__Orlve{display:flex;flex-direction:row;margin-top:20px}.MonthSelection-module_customContainer__4XPHq,.MonthSelection-module_standardContainer__1EEb-{display:flex;flex-direction:row}.MonthSelection-module_dayDropdown__bxWL2{margin-left:10px;width:50px}.MonthSelection-module_monthWeekdayDropdown__RoW6n,.MonthSelection-module_orderDropdown__H0a7L{margin-left:10px;margin-right:10px;width:100px}.MonthSelection-module_dayLabel__C04BX{margin-left:10px;margin-right:10px}.MonthSelection-module_orLabel__jqTMH{font-size:18px;margin-left:10px;margin-right:10px}.MonthSelection-module_onLabel__TJ8AO{font-size:16px;margin-right:20px;margin-top:3px}");const v=[...Array(32).keys()].filter((e=>0!==e)),w=["First","Second","Third","Fourth","Last"];function M(t){const l=t?.styles||{},{recurrenceData:o,dispatch:r}=e.useContext(d),{monthOption:c,selectedMonthDate:s,selectedMonthDayOrder:u,selectedMonthDay:y,disabled:m}=o,p=e=>{r({type:n.SetMonthOption,payload:e?.target?.value})};return a.default.createElement("div",{className:x.mainContainer,style:l.monthContainer},a.default.createElement("label",{className:x.onLabel,style:l.onLabel},"On"),a.default.createElement("div",{className:x.container},a.default.createElement("div",{className:x.standardContainer},a.default.createElement("input",{disabled:m,value:"standard",name:"monthOption",checked:"standard"===c,type:"radio",onChange:p}),a.default.createElement("select",{key:"standardMonthOption",disabled:m||"standard"!==c,value:s,className:x.dayDropdown,style:l.dayDropdown,onChange:e=>{r({type:n.SetMonthDate,payload:e?.target?.value})}},v.map((e=>a.default.createElement("option",{key:e,value:e},e)))),a.default.createElement("label",{style:{...l.dayLabel,color:""+("standard"!==c||m?"gray":"")},className:x.dayLabel},"day")),a.default.createElement("label",{className:x.orLabel,style:l.orLabel},"or"),a.default.createElement("div",{className:x.customContainer},a.default.createElement("input",{disabled:m,value:"custom",name:"monthOption",checked:"custom"===c,type:"radio",onChange:p}),a.default.createElement("select",{key:"orderSelection",disabled:m||"custom"!==c,value:u,className:x.orderDropdown,style:l.orderDropdown,onChange:e=>{r({type:n.SetMonthDayOrder,payload:e?.target?.value})}},w.map((e=>{const t=!["First","Last"].includes(e)&&"Weekday"===y;return a.default.createElement("option",{key:e,disabled:t,value:e},e)}))),a.default.createElement("select",{key:"weekdaySelection",disabled:m||"custom"!==c,value:y,className:x.monthWeekdayDropdown,style:l.monthWeekdayDropdown,onChange:e=>{r({type:n.SetMonthDay,payload:e?.target?.value})}},(()=>{let e=[...i];return e=e.concat([{name:"Day",value:"Day"},{name:"Weekday",value:"Weekday"}]),e})().map((e=>{const t="Weekday"===e.name&&!["First","Last"].includes(u);return a.default.createElement("option",{key:e.name,disabled:t,value:e.name},e.name)}))))))}const L=e=>{const t=new Date(e),a=i.find((e=>e.value===t?.getDay()))?.name;return a},W=e=>{const t=new Date(e);return u[t.getMonth()]},F=e=>{const t=new Date(e).getDate();return t>9?t:`0${t}`};function N(t){const n=t?.styles||{},{recurrenceData:l,dispatch:o}=e.useContext(d),{startDate:r,repeat:c,selectedWeeks:s,frequency:u,monthOption:y,selectedMonthDate:m,selectedMonthDayOrder:p,selectedMonthDay:_}=l,h=e.useCallback((()=>{if(!r)return"";const e=new Date(r),t=L(r),a=W(r);return`starting ${t}, ${F(r)} ${a} ${e.getFullYear()}`}),[r]),f=e.useCallback((()=>{let e=s;if(r){const t=new Date(r);e=s.filter((e=>e>=t.getDay())).concat(s.filter((e=>e<t.getDay())))}const t=[];if(e.forEach((e=>{const a=i.find((t=>t.value===e));a.name&&t.push(a.name)})),t.length>1){const e=t.pop(),a=t.pop();t.push(`${a} and ${e}`)}return t.join(", ")}),[r,s]);if("weekly"===c&&s?.length>0)return a.default.createElement("div",{style:{marginTop:20,...n.recurrenceText}},"Occurs",a.default.createElement("span",{style:{fontWeight:"bold",marginLeft:5,marginRight:5}},"every ",u>1?"weeks on":""," ",f()),h());if("monthly"===c){const e="standard"===y?`day ${m}`:`the ${p?.toLowerCase()} ${_}`;return a.default.createElement("div",{style:{marginTop:20,...n.recurrenceText}},"Occurs",a.default.createElement("span",{style:{fontWeight:"bold",marginLeft:5,marginRight:5}},e," of every ",u>1?"months":"month"),h())}return a.default.createElement(a.default.Fragment,null)}var q={container:"WeekSelection-module_container__88GLb",weekCheckBoxContainer:"WeekSelection-module_weekCheckBoxContainer__-iuB5",weekdayBtnContainer:"WeekSelection-module_weekdayBtnContainer__7G5w2",weekdayBtn:"WeekSelection-module_weekdayBtn__irczp",selectedWeekdayBtn:"WeekSelection-module_selectedWeekdayBtn__DjAad",weekdayFullTextLabel:"WeekSelection-module_weekdayFullTextLabel__foOGD"};function T(t){const l=t?.styles||{},{recurrenceData:o,dispatch:r}=e.useContext(d),{selectedWeeks:c,disabled:s}=o,u=e=>{const t=c.includes(e)?c.filter((t=>t!==e)).sort():c.concat([e]).sort();r({type:n.SetSelectedWeeks,payload:t})},y=e=>{let t=e?.target?.value;t&&(t=Number(t),u(t))};return a.default.createElement("div",{style:l.weekContainer},a.default.createElement("div",{className:q.container},i.map(((e,t)=>a.default.createElement("div",{key:t,className:q.weekdayBtnContainer,style:l.weekdayBtnContainer},a.default.createElement("button",{type:"button",disabled:s,value:e.value,className:c.includes(e.value)?q.selectedWeekdayBtn:q.weekdayBtn,style:c.includes(e.value)?l.selectedWeekdayBtn:l.weekdayBtn,onClick:t=>u(e.value)},e.name.slice(0,3)))))),a.default.createElement("div",{className:q.weekCheckBoxContainer},i.map((e=>a.default.createElement("label",{key:e.name},a.default.createElement("input",{disabled:s,checked:c.includes(e.value),type:"checkbox",onChange:y,value:e.value}),a.default.createElement("span",{className:q.weekdayFullTextLabel,style:c.includes(e.value)?l.selectedWeekdayFullTextLabel:l.weekdayFullTextLabel},e.name))))))}function O(t){const{recurrenceData:l,dispatch:o}=e.useContext(d),{repeat:r,selectedWeeks:c,cronExpression:s,monthOption:i,selectedMonthDate:u,selectedMonthDay:f,selectedMonthDayOrder:S,frequency:b,startDate:k,endDate:C,endCount:x,selectedEndType:v}=l;return e.useEffect((()=>{let e={...t};if(t.value&&(e={...e,...t.value}),e.cronExpression&&""!==e.cronExpression){const t=D(e.repeat,e.cronExpression);e.cronExpression&&e.cronExpression,t&&(e={...e,...t})}o({type:n.SetInitialProps,payload:e})}),[t]),e.useEffect((()=>{let e="";if("weekly"===r)e=y(c);else if("monthly"===r)if("custom"===i){const t=h(S);"Day"===f?e="Last"===S?"0 0 L * ?":m(t):"Weekday"===f?"First"===S?e="0 0 1W * ?":"Last"===S&&(e="0 0 LW * ?"):e="Last"===S?p(f):_(t,f)}else e=m(u);o({type:n.SetCronExp,payload:e})}),[r,c,i,u,f,S]),e.useEffect((()=>{const e={repeat:r,cronExpression:s,frequency:b,startDate:k};"date"===v?e.endDate=C:"count"===v&&(e.endCount=x),t.onChange&&t.onChange(e)}),[r,s,b,k,C,x,v]),a.default.createElement("div",{style:t?.styles?.root},a.default.createElement(g,t),"weekly"===r?a.default.createElement(T,t):"monthly"===r?a.default.createElement(M,t):null,a.default.createElement(E,t),a.default.createElement(N,t),t.showCronExpression&&a.default.createElement("div",{style:{marginTop:20}},s))}S('@media only screen and (min-width:641px){.WeekSelection-module_container__88GLb{display:flex;flex-direction:row}.WeekSelection-module_weekCheckBoxContainer__-iuB5{display:none}}@media only screen and (max-width:641px){.WeekSelection-module_container__88GLb{display:none}.WeekSelection-module_weekCheckBoxContainer__-iuB5{display:flex;flex-direction:column;margin-top:20px}}.WeekSelection-module_weekdayBtnContainer__7G5w2{margin:10px}.WeekSelection-module_weekdayBtn__irczp{background-color:#aaa}.WeekSelection-module_selectedWeekdayBtn__DjAad,.WeekSelection-module_weekdayBtn__irczp{border:1px;border-color:"#6b6b6b";border-radius:50%;color:#e2e2e2;height:40px;width:40px}.WeekSelection-module_selectedWeekdayBtn__DjAad{background-color:#4eaeec}.WeekSelection-module_weekdayFullTextLabel__foOGD{margin-left:5px}');exports.Recurrence=e=>a.default.createElement(s,null,a.default.createElement(O,e));
